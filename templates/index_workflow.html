{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="hero-premium">
  <div class="hero-container-premium">
    <div class="hero-content">
      <div class="hero-badge-premium">‚ú® Powered by Advanced AI</div>
      <h1 class="hero-headline-premium">Transform Documents into<br/>Actionable Intelligence</h1>
      <p class="hero-subheadline-premium">Analyze resumes, contracts, invoices, and more with cutting-edge AI. Get instant insights‚Äîno login required.</p>
      <div class="hero-ctas-premium">
        <a href="#tools" class="cta-primary">Get Started Free</a>
        <a href="#how-it-works" class="cta-secondary">See How It Works</a>
      </div>
      <div class="hero-stats-premium">
        <div class="stat-item-premium">
          <div class="stat-number-premium">9+</div>
          <div class="stat-label-premium">AI Tools</div>
        </div>
        <div class="stat-item-premium">
          <div class="stat-number-premium">100%</div>
          <div class="stat-label-premium">Free Forever</div>
        </div>
        <div class="stat-item-premium">
          <div class="stat-number-premium">Instant</div>
          <div class="stat-label-premium">Results</div>
        </div>
      </div>
    </div>
    <div class="hero-visual-premium">
      <div class="illustration-placeholder">
        <div class="illustration-gradient"></div>
        <div class="illustration-shapes">
          <div class="shape shape-1"></div>
          <div class="shape shape-2"></div>
          <div class="shape shape-3"></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Trust Badges -->
<section class="trust-section">
  <div class="container-premium">
    <p class="trust-label">Trusted by professionals worldwide</p>
    <div class="trust-logos">
      <div class="trust-logo">HR Teams</div>
      <div class="trust-logo">Legal Firms</div>
      <div class="trust-logo">Logistics</div>
      <div class="trust-logo">Finance</div>
    </div>
  </div>
</section>

<!-- Tools Grid -->
<section class="tools-section-premium" id="tools">
  <div class="container-premium">
    <div class="section-header-premium">
      <h2 class="section-title-premium">Powerful AI Tools</h2>
      <p class="section-description-premium">Choose from our comprehensive suite of document analysis tools</p>
    </div>
    <div class="tools-grid-premium">
      <div class="tool-card-premium" onclick="window.location.href='/pdf-summary'">
        <div class="tool-icon-premium">üìÑ</div>
        <h3 class="tool-title-premium">PDF Summary AI</h3>
        <p class="tool-desc-premium">Instantly summarize long documents and extract key insights</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="window.location.href='/invoice-reader'">
        <div class="tool-icon-premium">üßæ</div>
        <h3 class="tool-title-premium">Invoice Reader</h3>
        <p class="tool-desc-premium">Automatically extract invoice data and export to CSV</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="window.location.href='/contract-analyzer'">
        <div class="tool-icon-premium">üìë</div>
        <h3 class="tool-title-premium">Contract Analyzer</h3>
        <p class="tool-desc-premium">Break down contracts and identify risks instantly</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="window.location.href='/salary-slip'">
        <div class="tool-icon-premium">üí∞</div>
        <h3 class="tool-title-premium">Salary Slip Analyzer</h3>
        <p class="tool-desc-premium">Extract and validate payroll data with AI</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="switchTab('resume'); setTimeout(() => { document.getElementById('toolSection').style.display = 'block'; document.getElementById('toolSection').scrollIntoView({behavior: 'smooth'}); }, 100);">
        <div class="tool-icon-premium">üìÑ</div>
        <h3 class="tool-title-premium">Resume Analyzer</h3>
        <p class="tool-desc-premium">Get ATS scores and match with job descriptions</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="window.location.href='/website-summary'">
        <div class="tool-icon-premium">üåê</div>
        <h3 class="tool-title-premium">Website Summary</h3>
        <p class="tool-desc-premium">Convert any website into a structured summary</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="window.location.href='/business-docs-ai'">
        <div class="tool-icon-premium">üìä</div>
        <h3 class="tool-title-premium">Business Docs AI</h3>
        <p class="tool-desc-premium">Comprehensive analysis of business documents</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="switchTab('edi'); setTimeout(() => { document.getElementById('toolSection').style.display = 'block'; document.getElementById('toolSection').scrollIntoView({behavior: 'smooth'}); }, 100);">
        <div class="tool-icon-premium">üö¢</div>
        <h3 class="tool-title-premium">EDI Validator</h3>
        <p class="tool-desc-premium">Validate BAPLIE, MOVINS, COPRAR formats</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
      
      <div class="tool-card-premium" onclick="window.location.href='/website-analyzer'">
        <div class="tool-icon-premium">üîç</div>
        <h3 class="tool-title-premium">Website Analyzer</h3>
        <p class="tool-desc-premium">Get comprehensive SEO analysis and recommendations</p>
        <div class="tool-cta-premium">Open Tool ‚Üí</div>
      </div>
    </div>
  </div>
</section>

<!-- How It Works -->
<section class="how-it-works-premium" id="how-it-works">
  <div class="container-premium">
    <div class="section-header-premium">
      <h2 class="section-title-premium">How It Works</h2>
      <p class="section-description-premium">Get instant insights in three simple steps</p>
    </div>
    <div class="steps-grid-premium">
      <div class="step-card-premium">
        <div class="step-number-premium">1</div>
        <h3 class="step-title-premium">Upload</h3>
        <p class="step-desc-premium">Upload any PDF, EDI file, or enter a website URL</p>
      </div>
      <div class="step-card-premium">
        <div class="step-number-premium">2</div>
        <h3 class="step-title-premium">Analyze</h3>
        <p class="step-desc-premium">Our AI processes your document and extracts key information</p>
      </div>
      <div class="step-card-premium">
        <div class="step-number-premium">3</div>
        <h3 class="step-title-premium">Get Results</h3>
        <p class="step-desc-premium">Receive comprehensive analysis and actionable insights</p>
      </div>
    </div>
  </div>
</section>

<!-- Use Cases -->
<section class="use-cases-premium">
  <div class="container-premium">
    <div class="section-header-premium">
      <h2 class="section-title-premium">Use Cases</h2>
      <p class="section-description-premium">See how professionals use our tools</p>
    </div>
    <div class="use-cases-grid-premium">
      <div class="use-case-premium">
        <div class="use-case-icon-premium">üëî</div>
        <h3 class="use-case-title-premium">HR & Recruitment</h3>
        <p class="use-case-desc-premium">Screen resumes faster and identify top talent</p>
      </div>
      <div class="use-case-premium">
        <div class="use-case-icon-premium">‚öñÔ∏è</div>
        <h3 class="use-case-title-premium">Legal & Compliance</h3>
        <p class="use-case-desc-premium">Review contracts and ensure compliance</p>
      </div>
      <div class="use-case-premium">
        <div class="use-case-icon-premium">üì¶</div>
        <h3 class="use-case-title-premium">Logistics & Shipping</h3>
        <p class="use-case-desc-premium">Validate EDI files and maintain standards</p>
      </div>
      <div class="use-case-premium">
        <div class="use-case-icon-premium">üíº</div>
        <h3 class="use-case-title-premium">Finance & Accounting</h3>
        <p class="use-case-desc-premium">Process invoices and detect anomalies</p>
      </div>
    </div>
  </div>
</section>

<!-- SEO Content -->
<section class="seo-content-premium">
  <div class="container-premium">
    <div class="seo-content-wrapper-premium">
      <h2 class="seo-title-premium">AI-Powered Document Analysis: Transform Your Workflow with Intelligent Automation</h2>
      
      <p>In today's fast-paced business environment, document processing and analysis have become critical bottlenecks that slow down productivity and decision-making. Traditional manual review processes are time-consuming, error-prone, and simply cannot scale with the volume of documents modern organizations handle daily. This is where AI-powered document analysis platforms revolutionize how businesses interact with their documents.</p>

      <p>Our comprehensive suite of AI document analysis tools leverages cutting-edge artificial intelligence and machine learning technologies to provide instant, accurate, and actionable insights from a wide variety of document types. Whether you're dealing with resumes, contracts, invoices, EDI files, or website content, our platform transforms raw documents into structured, analyzable data in seconds.</p>

      <h3>Revolutionary AI Technology for Document Intelligence</h3>
      
      <p>The foundation of our platform rests on advanced natural language processing (NLP) and computer vision technologies that can understand context, extract meaning, and identify patterns in documents just like a human expert would‚Äîbut at machine speed and scale. Our AI models have been trained on millions of documents across various industries, enabling them to recognize document structures, extract key information, identify anomalies, and provide intelligent recommendations.</p>

      <p>For HR professionals and recruiters, our Resume Analyzer tool offers unprecedented capabilities. It calculates ATS (Applicant Tracking System) compatibility scores, matches resumes against job descriptions, identifies skill gaps, and provides specific recommendations for improvement. This not only speeds up the recruitment process but also helps candidates optimize their resumes for better job opportunities.</p>

      <h3>Comprehensive Business Document Analysis</h3>
      
      <p>Legal and compliance teams benefit immensely from our Contract Analyzer, which can process complex legal documents, identify key clauses, flag potential risks, detect missing terms, and even suggest negotiation points. This level of analysis, which would typically take hours of manual review, is completed in seconds with remarkable accuracy.</p>

      <p>Finance and accounting departments can leverage our Invoice Reader to automatically extract line items, quantities, prices, taxes, and totals from invoices. The system can detect suspicious charges, validate calculations, and export data directly to CSV format for seamless integration with existing accounting systems. This automation eliminates manual data entry errors and frees up valuable time for strategic financial analysis.</p>

      <h3>Specialized Tools for Industry-Specific Needs</h3>
      
      <p>Our EDI Validator addresses the unique needs of logistics and shipping industries. It validates BAPLIE, MOVINS, COPRAR, and other EDI formats, ensuring compliance with industry standards. The tool detects structural errors, validates container data, identifies missing segments, and provides comprehensive validation reports. This is particularly valuable for companies handling international shipping where EDI compliance is mandatory.</p>

      <p>For marketing and SEO professionals, our Website Analyzer provides comprehensive website audits including SEO scoring, content structure analysis, keyword extraction, and actionable optimization recommendations. This tool helps businesses improve their online presence and search engine rankings through data-driven insights.</p>

      <h3>Privacy, Security, and Accessibility</h3>
      
      <p>One of the most significant advantages of our platform is its commitment to privacy and security. Documents are processed securely and are not stored permanently, ensuring complete data protection. The platform is designed to be accessible to everyone‚Äîno login required, no credit card needed, and completely free to use. This democratizes access to enterprise-grade AI document analysis capabilities that were previously available only to large organizations with substantial budgets.</p>

      <p>Our multi-format support means users can analyze PDFs, text documents, EDI files, and even entire websites through URL input. This versatility makes our platform a one-stop solution for all document analysis needs, eliminating the need for multiple specialized tools.</p>

      <h3>The Future of Document Processing</h3>
      
      <p>As artificial intelligence continues to evolve, the capabilities of document analysis platforms will only expand. Our platform represents the current state-of-the-art in AI-powered document intelligence, combining speed, accuracy, and ease of use in a way that transforms how professionals interact with documents.</p>

      <p>Whether you're a job seeker optimizing your resume, a legal professional reviewing contracts, a logistics manager validating EDI files, or a business owner processing invoices, our AI document analysis platform provides the tools you need to work smarter, faster, and more effectively. Experience the future of document processing today‚Äîcompletely free, with no strings attached.</p>
    </div>
  </div>
</section>

<!-- Main Content Container - Only show when tab is clicked -->
<div class="main-content-wrapper" id="toolSection" style="display: none;">
  <!-- Tabs Section -->
  <div class="tabs-wrapper">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('resume')">
        <span class="tab-icon">üìÑ</span>
        <span>Resume</span>
      </button>
      <button class="tab-btn" onclick="switchTab('business')">
        <span class="tab-icon">üìä</span>
        <span>Business Docs</span>
      </button>
      <button class="tab-btn" onclick="switchTab('edi')">
        <span class="tab-icon">üö¢</span>
        <span>Logistics EDI</span>
      </button>
      <button class="tab-btn" onclick="switchTab('website')">
        <span class="tab-icon">üåê</span>
        <span>Website Analyzer</span>
      </button>
    </div>
  </div>

  <!-- Resume Tab -->
  <div id="resume-tab" class="tab-content active">
    <h2 class="tab-title">üìÑ Resume Analyzer</h2>
    <p class="tab-description">Upload your resume to get ATS score, match with job descriptions, and get AI-powered improvements.</p>
    
    <button onclick="tryDemoResume()" class="demo-btn-large">‚ú® Try Example Resume</button>
    
    <div class="upload-card">
      <h3 class="upload-header">Upload Document</h3>
      <form id="resumeUploadForm" enctype="multipart/form-data">
        <label class="upload-label">Upload Resume:</label>
        <input type="file" id="resumeFile" accept=".pdf" class="file-input" />
        <button type="submit" class="upload-btn">Upload Resume</button>
      </form>
      
      <form id="jdUploadForm" enctype="multipart/form-data" class="upload-form-secondary">
        <label class="upload-label">Upload Job Description (Optional):</label>
        <input type="file" id="jdFile" accept=".pdf" class="file-input" />
        <button type="submit" class="upload-btn">Upload JD</button>
      </form>
      
      <div class="sample-links">
        <a href="#" onclick="tryDemoResume(); return false;">Try Sample Resume</a>
      </div>
    </div>

    <div id="resumeStatus" class="status-message"></div>

    <div class="workflow-actions" id="resumeActions" style="display: none;">
      <button onclick="getATSScore()" class="workflow-btn">Get ATS Score</button>
      <button onclick="matchWithJD()" class="workflow-btn">Match with JD</button>
      <button onclick="getFullReport()" class="workflow-btn">Full Report</button>
      <button onclick="rewriteResume()" class="workflow-btn">Rewrite Resume</button>
      <button onclick="shareResult()" class="workflow-btn share">Share Result</button>
      <button onclick="copyResult()" class="workflow-btn copy">Copy Result</button>
    </div>

    <div id="resumeResults" class="results-section"></div>
  </div>

  <!-- Business Docs Tab -->
  <div id="business-tab" class="tab-content">
    <h2 class="tab-title">üìä Business Documents</h2>
    <p class="tab-description">Analyze contracts, invoices, and business documents with AI workflows.</p>
    
    <button onclick="tryDemoBusiness()" class="demo-btn-large">‚ú® Analyze Sample Invoice</button>
    
    <div class="upload-card">
      <h3 class="upload-header">Upload Document</h3>
      <form id="businessUploadForm" enctype="multipart/form-data">
        <label class="upload-label">Upload Document:</label>
        <input type="file" id="businessFile" accept=".pdf" class="file-input" />
        <button type="submit" class="upload-btn">Upload</button>
      </form>
    </div>

    <div id="businessStatus" class="status-message"></div>

    <div class="workflow-actions" id="businessActions" style="display: none;">
      <button onclick="extractInsights()" class="workflow-btn">Extract Insights</button>
      <button onclick="generateActionItems()" class="workflow-btn">Action Items</button>
      <button onclick="createSummary()" class="workflow-btn">Create Summary</button>
      <button onclick="riskAnalysis()" class="workflow-btn">Risk Analysis</button>
      <button onclick="generateEmail()" class="workflow-btn">Email Draft</button>
      <button onclick="shareResult()" class="workflow-btn share">Share Result</button>
    </div>

    <div class="output-format-selector">
      <label>Export Format:</label>
      <select id="outputFormat">
        <option value="json">JSON</option>
        <option value="excel">Excel/CSV</option>
        <option value="email">Email</option>
        <option value="slack">Slack</option>
        <option value="teams">Teams</option>
      </select>
      <button onclick="exportData()" class="export-btn">Export</button>
    </div>

    <div id="businessResults" class="results-section"></div>
  </div>

  <!-- EDI Tab -->
  <div id="edi-tab" class="tab-content">
    <h2 class="tab-title">üö¢ Logistics EDI Analyzer</h2>
    <p class="tab-description">Validate and analyze EDI documents (BAPLIE, MOVINS, COPRAR).</p>
    
    <button onclick="tryDemoEDI()" class="demo-btn-large">‚ú® Try Sample BAPLIE</button>
    
    <div class="upload-card">
      <h3 class="upload-header">Upload EDI Document</h3>
      <form id="ediUploadForm" enctype="multipart/form-data">
        <label class="upload-label">Upload EDI Document:</label>
        <input type="file" id="ediFile" accept=".edi,.txt,.baplie,.movins,.coprar" class="file-input" />
        <button type="submit" class="upload-btn">Upload & Analyze</button>
      </form>
      
      <div class="sample-links">
        <a href="#" onclick="tryDemoEDI(); return false;">Try Sample BAPLIE</a>
      </div>
    </div>

    <div id="ediStatus" class="status-message"></div>
    <div id="ediResults" class="results-section"></div>
  </div>

  <!-- Website Tab -->
  <div id="website-tab" class="tab-content">
    <h2 class="tab-title">üåê Website Analyzer</h2>
    <p class="tab-description">Analyze website content and extract insights.</p>
    
    <button onclick="tryDemoWebsite()" class="demo-btn-large">‚ú® Analyze aigpt.co.in</button>
    
    <div class="upload-card">
      <h3 class="upload-header">Enter Website URL</h3>
      <form id="urlForm">
        <label class="upload-label">Enter Website URL:</label>
        <input type="url" id="urlInput" placeholder="https://example.com" class="url-input" />
        <button type="submit" class="upload-btn">Analyze Website</button>
      </form>
    </div>

    <div id="websiteStatus" class="status-message"></div>

    <div class="workflow-actions" id="websiteActions" style="display: none;">
      <button onclick="extractInsights()" class="workflow-btn">Extract Insights</button>
      <button onclick="createSummary()" class="workflow-btn">Create Summary</button>
      <button onclick="shareResult()" class="workflow-btn share">Share Result</button>
    </div>

    <div id="websiteResults" class="results-section"></div>
  </div>
</div>

<script>
let currentFileId = "active";
let currentTab = "resume";

function switchTab(tabName) {
  const toolSection = document.getElementById('toolSection');
  if (toolSection) {
    toolSection.style.display = 'block';
  }
  
  document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  
  const targetTab = document.getElementById(tabName + '-tab');
  if (targetTab) {
    targetTab.classList.add('active');
  }
  
  const buttons = document.querySelectorAll('.tab-btn');
  buttons.forEach(btn => {
    const btnText = btn.textContent.toLowerCase();
    if ((tabName === 'resume' && btnText.includes('resume')) ||
        (tabName === 'business' && btnText.includes('business')) ||
        (tabName === 'edi' && btnText.includes('edi')) ||
        (tabName === 'website' && btnText.includes('website'))) {
      btn.classList.add('active');
    }
  });
  
  currentTab = tabName;
  
  setTimeout(() => {
    toolSection?.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 100);
}

// Resume Analyzer Functions
document.getElementById("resumeUploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData();
  formData.append("file", document.getElementById("resumeFile").files[0]);
  formData.append("file_id", "active");
  
  const res = await fetch("/api/upload-multi", { method: "POST", body: formData });
  const data = await res.json();
  document.getElementById("resumeStatus").innerHTML = data.message ? `<div class="success-message">‚úÖ ${data.message}</div>` : `<div class="error-message">‚ùå ${data.error}</div>`;
  if (data.message) document.getElementById("resumeActions").style.display = "flex";
});

document.getElementById("jdUploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData();
  formData.append("file", document.getElementById("jdFile").files[0]);
  formData.append("file_id", "jd");
  
  const res = await fetch("/api/upload-multi", { method: "POST", body: formData });
  const data = await res.json();
  const currentStatus = document.getElementById("resumeStatus").innerHTML;
  document.getElementById("resumeStatus").innerHTML = currentStatus + (data.message ? `<div class="success-message">‚úÖ ${data.message}</div>` : `<div class="error-message">‚ùå ${data.error}</div>`);
});

async function getATSScore() {
  document.getElementById("resumeResults").innerHTML = '<div class="loading">‚è≥ Calculating ATS Score...</div>';
  try {
    const res = await fetch("/api/resume/ats-score", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({})
    });
    const data = await res.json();
    displayResumeResults("resumeResults", data, "ats");
    document.getElementById("resumeResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch (error) {
    document.getElementById("resumeResults").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
}

async function matchWithJD() {
  const res = await fetch("/api/resume/match-jd", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ jd_file_id: "jd" })
  });
  const data = await res.json();
  displayResults("resumeResults", data);
}

async function getFullReport() {
  document.getElementById("resumeResults").innerHTML = '<div class="loading">‚è≥ Generating full report...</div>';
  try {
    const res = await fetch("/api/resume/full-report", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ jd_file_id: "jd" })
    });
    const data = await res.json();
    displayResumeResults("resumeResults", data, "full");
    document.getElementById("resumeResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch (error) {
    document.getElementById("resumeResults").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
}

async function rewriteResume() {
  const res = await fetch("/api/resume/rewrite", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ improvements: [] })
  });
  const data = await res.json();
  displayResults("resumeResults", data);
}

// Business Docs Functions
document.getElementById("businessUploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData();
  formData.append("file", document.getElementById("businessFile").files[0]);
  
  const res = await fetch("/upload", { method: "POST", body: formData });
  const data = await res.json();
  document.getElementById("businessStatus").innerHTML = data.message ? `<div class="success-message">‚úÖ ${data.message}</div>` : `<div class="error-message">‚ùå ${data.error}</div>`;
  if (data.message) document.getElementById("businessActions").style.display = "flex";
});

async function extractInsights() {
  document.getElementById("businessResults").innerHTML = '<div class="loading">‚è≥ Extracting insights...</div>';
  try {
    const res = await fetch("/api/workflow/extract-insights", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ document_type: "business" })
    });
    const data = await res.json();
    displayBusinessResults("businessResults", data);
    document.getElementById("businessResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch (error) {
    document.getElementById("businessResults").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
}

async function generateActionItems() {
  const res = await fetch("/api/workflow/action-items", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({})
  });
  const data = await res.json();
  displayResults("businessResults", data);
}

async function createSummary() {
  const res = await fetch("/api/workflow/summary", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ type: "executive" })
  });
  const data = await res.json();
  displayResults("businessResults", data);
}

async function riskAnalysis() {
  const res = await fetch("/api/workflow/risk-analysis", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({})
  });
  const data = await res.json();
  displayResults("businessResults", data);
}

async function generateEmail() {
  const res = await fetch("/api/workflow/email-draft", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ type: "summary" })
  });
  const data = await res.json();
  displayResults("businessResults", data);
}

// EDI Functions
document.getElementById("ediUploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const file = document.getElementById("ediFile").files[0];
  if (!file) {
    document.getElementById("ediStatus").innerHTML = '<div class="error-message">Please select a file</div>';
    return;
  }
  
  const formData = new FormData();
  formData.append("file", file);
  
  document.getElementById("ediStatus").innerHTML = '<div class="loading">‚è≥ Analyzing EDI file...</div>';
  document.getElementById("ediResults").innerHTML = "";
  
  try {
    const res = await fetch("/api/analyze-edi", {
      method: "POST",
      body: formData
    });
    const data = await res.json();
    
    if (data.error) {
      document.getElementById("ediStatus").innerHTML = `<div class="error-message">‚ùå ${data.error}</div>`;
    } else {
      document.getElementById("ediStatus").innerHTML = '<div class="success-message">‚úÖ EDI file analyzed successfully!</div>';
      displayEDIResults("ediResults", data);
      document.getElementById("ediResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  } catch (error) {
    document.getElementById("ediStatus").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
});

// Website Functions
document.getElementById("urlForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const url = document.getElementById("urlInput").value;
  if (!url) {
    document.getElementById("websiteStatus").innerHTML = '<div class="error-message">Please enter a URL</div>';
    return;
  }
  
  document.getElementById("websiteStatus").innerHTML = '<div class="loading">‚è≥ Analyzing website...</div>';
  document.getElementById("websiteResults").innerHTML = "";
  
  try {
    const res = await fetch("/api/analyze-website", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ url })
    });
    const data = await res.json();
    
    if (data.error) {
      document.getElementById("websiteStatus").innerHTML = `<div class="error-message">‚ùå ${data.error}</div>`;
    } else {
      document.getElementById("websiteStatus").innerHTML = '<div class="success-message">‚úÖ Website analyzed successfully!</div>';
      document.getElementById("websiteActions").style.display = "flex";
      displayWebsiteResults("websiteResults", data);
      document.getElementById("websiteResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  } catch (error) {
    document.getElementById("websiteStatus").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
});

// Demo Functions
async function tryDemoResume() {
  document.getElementById("resumeResults").innerHTML = '<div class="loading">‚è≥ Loading demo resume analysis...</div>';
  try {
    const res = await fetch("/api/demo/resume");
    const data = await res.json();
    displayResumeResults("resumeResults", data, "ats");
    document.getElementById("resumeResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch (error) {
    document.getElementById("resumeResults").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
}

async function tryDemoBusiness() {
  const res = await fetch("/api/demo/business");
  const data = await res.json();
  displayResults("businessResults", data.sampleData);
}

async function tryDemoEDI() {
  document.getElementById("ediStatus").innerHTML = '<div class="loading">‚è≥ Loading demo EDI analysis...</div>';
  document.getElementById("ediResults").innerHTML = "";
  try {
    const res = await fetch("/api/demo/edi");
    const data = await res.json();
    displayEDIResults("ediResults", data);
    document.getElementById("ediStatus").innerHTML = '<div class="success-message">‚úÖ Demo EDI analysis loaded!</div>';
    document.getElementById("ediResults").scrollIntoView({ behavior: 'smooth', block: 'start' });
  } catch (error) {
    document.getElementById("ediStatus").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
}

async function tryDemoWebsite() {
  const url = "https://aigpt.co.in";
  document.getElementById("websiteStatus").innerHTML = '<div class="loading">‚è≥ Analyzing demo website...</div>';
  document.getElementById("websiteResults").innerHTML = "";
  
  try {
    const res = await fetch("/api/analyze-website", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ url })
    });
    const data = await res.json();
    
    if (data.error) {
      document.getElementById("websiteStatus").innerHTML = `<div class="error-message">‚ùå ${data.error}</div>`;
    } else {
      document.getElementById("websiteStatus").innerHTML = '<div class="success-message">‚úÖ Demo analysis complete!</div>';
      document.getElementById("websiteActions").style.display = "flex";
      displayWebsiteResults("websiteResults", data);
    }
  } catch (error) {
    document.getElementById("websiteStatus").innerHTML = `<div class="error-message">‚ùå Error: ${error.message}</div>`;
  }
}

// Share Functions
function shareResult() {
  const shareUrl = window.location.href;
  if (navigator.share) {
    navigator.share({ title: "AI Document Analysis", url: shareUrl });
  } else {
    navigator.clipboard.writeText(shareUrl);
    alert("Link copied to clipboard!");
  }
}

function copyResult() {
  const results = document.querySelectorAll('.result-card pre');
  if (results.length > 0) {
    navigator.clipboard.writeText(results[0].innerText);
    alert("Results copied to clipboard!");
  }
}

// Utility Functions
function displayResults(containerId, data) {
  const container = document.getElementById(containerId);
  container.innerHTML = `<div class="result-card fade-in"><h3 class="result-header">AI Results</h3><pre class="result-json">${JSON.stringify(data, null, 2)}</pre><button onclick="copyResult()" class="copy-btn">üìã Copy Result</button></div>`;
}

function displayEDIResults(containerId, data) {
  const container = document.getElementById(containerId);
  let html = '<div class="result-card fade-in"><h3 class="result-header">üìä EDI Analysis Results</h3>';
  
  const validation = data.validation || {};
  if (validation.isValid) {
    html += '<div class="result-section success-card"><h4>‚úÖ Validation: PASSED</h4></div>';
  } else {
    html += '<div class="result-section error-card"><h4>‚ùå Validation: FAILED</h4></div>';
  }
  
  if (validation.errors && validation.errors.length > 0) {
    html += '<div class="result-section error-card"><h4>‚ùå Errors:</h4><ul>';
    validation.errors.forEach(err => html += `<li>${err}</li>`);
    html += '</ul></div>';
  }
  
  if (validation.warnings && validation.warnings.length > 0) {
    html += '<div class="result-section warning-card"><h4>‚ö†Ô∏è Warnings:</h4><ul>';
    validation.warnings.forEach(warn => html += `<li>${warn}</li>`);
    html += '</ul></div>';
  }
  
  if (data.summary) {
    html += `<div class="result-section"><h4>üìù Summary:</h4><p>${data.summary}</p></div>`;
  }
  
  if (validation.containersFound > 0) {
    html += `<div class="result-section"><h4>üì¶ Containers Found: ${validation.containersFound}</h4></div>`;
  }
  
  html += `<details class="result-section"><summary>View Full JSON</summary><pre class="result-json">${JSON.stringify(data, null, 2)}</pre></details>`;
  html += '<button onclick="copyResult()" class="copy-btn">üìã Copy Result</button></div>';
  
  container.innerHTML = html;
}

function displayResumeResults(containerId, data, type = "ats") {
  const container = document.getElementById(containerId);
  let html = '<div class="result-card fade-in"><h3 class="result-header">üìÑ Resume Analysis Results</h3>';
  
  if (type === "full") {
    const atsScore = data.atsScore || {};
    const overallScore = atsScore.overallScore || 0;
    html += `<div class="result-section success-card"><h4>üéØ Overall ATS Score: <span class="score-badge">${overallScore}/100</span></h4></div>`;
    
    if (atsScore.strengths && atsScore.strengths.length > 0) {
      html += '<div class="result-section suggestion-card"><h4>‚úÖ Strengths:</h4><ul>';
      atsScore.strengths.forEach(str => html += `<li>${str}</li>`);
      html += '</ul></div>';
    }
    
    if (atsScore.weaknesses && atsScore.weaknesses.length > 0) {
      html += '<div class="result-section error-card"><h4>‚ö†Ô∏è Weaknesses:</h4><ul>';
      atsScore.weaknesses.forEach(weak => html += `<li>${weak}</li>`);
      html += '</ul></div>';
    }
  } else {
    const overallScore = data.overallScore || 0;
    html += `<div class="result-section success-card"><h4>üéØ ATS Score: <span class="score-badge">${overallScore}/100</span></h4></div>`;
    
    if (data.strengths && data.strengths.length > 0) {
      html += '<div class="result-section suggestion-card"><h4>‚úÖ Strengths:</h4><ul>';
      data.strengths.forEach(str => html += `<li>${str}</li>`);
      html += '</ul></div>';
    }
  }
  
  html += `<details class="result-section"><summary>View Full JSON</summary><pre class="result-json">${JSON.stringify(data, null, 2)}</pre></details>`;
  html += '<button onclick="copyResult()" class="copy-btn">üìã Copy Result</button></div>';
  
  container.innerHTML = html;
}

function displayBusinessResults(containerId, data) {
  const container = document.getElementById(containerId);
  let html = '<div class="result-card fade-in"><h3 class="result-header">üìä Business Document Analysis</h3>';
  
  if (data.summary) {
    html += `<div class="result-section"><h4>üìù Summary:</h4><p>${data.summary}</p></div>`;
  }
  
  if (data.risks && data.risks.length > 0) {
    html += '<div class="result-section error-card"><h4>‚ö†Ô∏è Risks & Red Flags:</h4><ul>';
    data.risks.forEach(risk => html += `<li>${risk}</li>`);
    html += '</ul></div>';
  }
  
  html += `<details class="result-section"><summary>View Full JSON</summary><pre class="result-json">${JSON.stringify(data, null, 2)}</pre></details>`;
  html += '<button onclick="copyResult()" class="copy-btn">üìã Copy Result</button></div>';
  
  container.innerHTML = html;
}

function displayWebsiteResults(containerId, data) {
  const container = document.getElementById(containerId);
  let html = '<div class="result-card fade-in"><h3 class="result-header">üåê Website Analysis Results</h3>';
  
  const seoAnalysis = data.seoAnalysis || {};
  const seoScore = seoAnalysis.seoScore || 0;
  html += `<div class="result-section"><h4>SEO Score: <span class="score-badge">${seoScore}/100</span></h4></div>`;
  
  if (data.issues && data.issues.length > 0) {
    html += '<div class="result-section error-card"><h4>‚ùå Issues:</h4><ul>';
    data.issues.forEach(issue => html += `<li>${issue}</li>`);
    html += '</ul></div>';
  }
  
  if (data.recommendations && data.recommendations.length > 0) {
    html += '<div class="result-section suggestion-card"><h4>‚úÖ Recommendations:</h4><ul>';
    data.recommendations.forEach(rec => html += `<li>${rec}</li>`);
    html += '</ul></div>';
  }
  
  html += `<details class="result-section"><summary>View Full JSON</summary><pre class="result-json">${JSON.stringify(data, null, 2)}</pre></details>`;
  html += '<button onclick="copyResult()" class="copy-btn">üìã Copy Result</button></div>';
  
  container.innerHTML = html;
}

async function exportData() {
  const format = document.getElementById("outputFormat").value;
  const results = document.getElementById("businessResults").innerText;
  
  const res = await fetch(`/api/export/${format}`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ data: JSON.parse(results || "{}") })
  });
  
  if (format === "json" || format === "excel") {
    const blob = await res.blob();
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `export.${format === "json" ? "json" : "csv"}`;
    a.click();
  } else {
    const data = await res.json();
    alert(`Export ready! Check console for ${format} format.`);
    console.log(data);
  }
}
</script>
{% endblock %}
